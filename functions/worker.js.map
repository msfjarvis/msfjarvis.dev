{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.ts","webpack:///./src/handler.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","addEventListener","event","respondWith","handleRequest","request","GITHUB_URL","APS_GITHUB_URL","PAYID_DATA","addresses","paymentNetwork","environment","addressDetailsType","addressDetails","address","payId","DENYLIST_REGEX","RegExp","async","submitStats","fetch","url","headers","split","reverse","Response","JSON","stringify","sendPayID","startsWith","redirect","replace","redirectDownload","urlParts","length","redirectGitHub","test"],"mappings":"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","file":"worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import { handleRequest } from './handler'\n\naddEventListener('fetch', (event) => {\n  event.respondWith(handleRequest(event.request))\n})\n","const BASE_URL = 'https://staging.msfjarvis.dev/'\nconst DOWNLOAD_URL = 'https://download.msfjarvis.dev/'\nconst DOWNLOAD_DEST_URL = 'https://dl.msfjarvis.dev/'\nconst STATS_URL = 'https://stats.msfjarvis.dev/'\nconst GITHUB_USERNAME = 'msfjarvis'\nconst APS_SLUG = 'Android-Password-Store/Android-Password-Store'\nconst GITHUB_URL = `https://github.com/${GITHUB_USERNAME}`\nconst APS_GITHUB_URL = `https://github.com/${APS_SLUG}`\nconst PAYID_DATA = {\n  harsh: {\n    addresses: [\n      {\n        paymentNetwork: 'BTC',\n        environment: 'MAINNET',\n        addressDetailsType: 'CryptoAddressDetails',\n        addressDetails: {\n          address: '1LbHbfTq1ZtE8u3qipCTJTcJYptvzc54aB',\n        },\n      },\n    ],\n    payId: 'harsh$msfjarvis.dev',\n  },\n}\nconst DENYLIST_REGEX = new RegExp('/asp|css|fbclid|ico|js|passwd|php|txt|webp|xml/gm');\n\nexport async function handleRequest(request: Request): Promise<Response> {\n  if (request.headers.get('Accept') == 'application/btc-mainnet+json') {\n    return sendPayID(request)\n  } else if (request.url.startsWith(DOWNLOAD_URL)) {\n    return redirectDownload(request)\n  } else if (request.url.startsWith(BASE_URL)) {\n    return redirectGitHub(request)\n  } else {\n    if (!DENYLIST_REGEX.test(request.url)) {\n      await submitStats(request)\n    }\n    return fetch(request)\n  }\n}\n\nasync function sendPayID(request: Request): Promise<Response> {\n  switch (request.url.split('/').reverse()[0]) {\n    case 'harsh':\n      return new Response(JSON.stringify(PAYID_DATA.harsh))\n  }\n  return fetch(request)\n}\n\nasync function redirectDownload(request: Request): Promise<Response> {\n  return Response.redirect(\n    request.url.replace(DOWNLOAD_URL, DOWNLOAD_DEST_URL),\n    301,\n  )\n}\n\nasync function redirectGitHub(request: Request): Promise<Response> {\n  await submitStats(request)\n  const urlParts = request.url.replace(BASE_URL, '').split('/')\n  switch (urlParts[0]) {\n    case 'g':\n      switch (urlParts.length) {\n        case 1:\n          return Response.redirect(GITHUB_URL, 301)\n        case 2:\n          return Response.redirect(`${GITHUB_URL}/${urlParts[1]}`, 301)\n        case 3:\n          return Response.redirect(\n            `${GITHUB_URL}/${urlParts[1]}/commit/${urlParts[2]}`,\n            301,\n          )\n      }\n    case 'ga':\n    case 'aps':\n      switch (urlParts.length) {\n        case 1:\n          return Response.redirect(APS_GITHUB_URL, 301)\n        case 2:\n          return Response.redirect(\n            `${APS_GITHUB_URL}/commit/${urlParts[1]}`,\n            301,\n          )\n        case 3:\n          return Response.redirect(\n            `${APS_GITHUB_URL}/issues/${urlParts[2]}`,\n            301,\n          )\n      }\n  }\n  return fetch(request)\n}\n\nasync function submitStats(request: Request): Promise<Response> {\n  return fetch(`${STATS_URL}/view?url=${request.url}`)\n}\n"],"sourceRoot":""}